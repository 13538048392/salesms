<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sales Network</title>
    <script src="/static/js/jquery-3.3.1.min.js"></script>
    <script src="/static/js/bootstrap.js"></script>
    <link rel="stylesheet" href="/static/css/bootstrap.css">
    <script src="/static/js/home.js"></script>
    <link href="/static/css/normalize.css" rel="stylesheet" type="text/css">
    <link href="/static/css/webflow.css" rel="stylesheet" type="text/css">
    <link href="/static/css/alexs-login-project.webflow.css" rel="stylesheet" type="text/css">
    <script type="text/javascript">WebFont.load({  google: {    families: ["Montserrat:100,100italic,200,200italic,300,300italic,400,400italic,500,500italic,600,600italic,700,700italic,800,800italic,900,900italic","Source Sans Pro:300,regular,900"]  }});</script>
    <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
    <link href="https://daks2k3a4ib2z.cloudfront.net/img/favicon.ico" rel="shortcut icon" type="image/x-icon">
    <link href="https://daks2k3a4ib2z.cloudfront.net/img/webclip.png" rel="apple-touch-icon">

    <style>
        @media screen and (max-width: 990px) {
            .search-btn {
                width: 100%;
            }
        }

        .search-container {
            margin-bottom: 30px;
        }

        .search-container > div {
            margin-bottom: 10px;
        }

        .table tbody tr:nth-child(odd) {
            background-color: #90cf96;
        }

        .container {
            margin-top: 50px;
        }

    </style>
    <script>
        url_search = "<?php echo url('/referrer/search')?>";
    </script>
</head>
<body>
{include file="../application/index/view/public/_header2.html"}

<div class="l-flex-center is--full w-container">
      <div class="c-login">
        <div class="c-login__title">
          <div>{$Think.lang.referral}</div>
        </div>
        <div class="c-login__body">
          <div class="w-form">
            <form id="wf-form-aform" name="wf-form-aform" data-name="aform" method="post" action="<?php echo url('/referrer/search')?>">
              <div class="w-row">
                <div class="w-col w-col-2"><input type="text" class="text-field w-input" maxlength="256" name="first_name" data-name="first_name" placeholder="{$Think.lang.first_name}" id="first_name" ></div>

                <div class="w-col w-col-2"><input type="text" class="text-field w-input" maxlength="256" name="last_name" data-name="last_name" placeholder="{$Think.lang.last_name}" id="last_name" ></div>

                <div class="w-col w-col-4"><input type="text" class="text-field w-input" maxlength="256" name="username" data-name="username" placeholder="{$Think.lang.username}" id="username" ></div>

                <div class="w-col w-col-2"><input type="text" class="text-field w-input" maxlength="256" name="channel_name" data-name="channel_name" placeholder="{$Think.lang.channel_name}" id="channel_name" ></div>

                <div class="w-clearfix w-col w-col-2">
                <button id="search" class="export_csv_submit w-button"> {$Think.lang.search} </button>
                </div>
              </div>
              <div class="w-embed"><input type="hidden" name="action" value="reg2">
                <input type="hidden" name="regcode" value=""></div>
              <div></div>
            </form>

            <div class="w-form-done">
              <div>Thank you! Your submission has been received!</div>
            </div>
            <div class="w-form-fail">
              <div>Oops! Something went wrong while submitting the form.</div>
            </div>
          </div>
          <div>
            <div class="row w-hidden-small w-row">
              <div class="w-col w-col-2">
                <div class="text-block-2 channel_label">{$Think.lang.channel_name}</div>
              </div>
              <div class="w-clearfix w-col w-col-2">
                <div class="channel_label">{$Think.lang.first_name}</div>
              </div>
              <div class="w-clearfix w-col w-col-2">
                <div class="channel_label">{$Think.lang.last_name}</div>
              </div>
              <div class="w-clearfix w-col w-col-4">
                <div class="channel_label">{$Think.lang.username}</div>
              </div>
              <div class="w-clearfix w-col w-col-2">
                <div class="channel_label">{$Think.lang.signup_date}</div>
              </div>
            </div>
            <div class="div-block-3"></div>

            {volist name="data" id="vo"}
                
                <?php
                    $list[0] = $vo;
                    $c_fix = '';
                    while(!empty($list))
                    {
                        $one = array_shift($list);
                        
                            echo "<div class='row-2 w-row'>";
                            echo "<div class='w-col w-col-2'><div class='text-block-3'>$one[channel_name]<br></div></div>"; 
                            echo "<div class='w-col w-col-2'><div class='text-block-3'>$one[first_name]<br></div></div>";
                            echo "<div class='w-col w-col-2'><div class='text-block-4'>$one[last_name]</div></div>";
                            echo "<div class='w-col w-col-4'><div class='text-block-4'>$c_fix$one[user_name]</div></div>";
                            echo "<div class='column-3 w-col w-col-2'><div class='text-block-4'>$one[create_time]</div></div>";
                            echo "</div>";

                            if(isset($one['_child'])){
                            $list = array_merge($list,$one['_child']);
                        }
                        $c_fix.= '--';
                    }
                ?>
            {/volist}
            

          </div>
        </div>
      </div>
      <div class="w-form">
        <form id="email-form" name="email-form" data-name="Email Form" class="w-clearfix" method="post" action="<?php echo url('/referrer/export')?>"><input type="submit" value="{$Think.lang.export} CSV" data-wait="Please wait..." class="export_csv_submit w-button"></form>
        <div class="w-form-done">
          <div>Thank you! Your submission has been received!</div>
        </div>
        <div class="w-form-fail">
          <div>Oops! Something went wrong while submitting the form.</div>
        </div>
      </div>
    </div>


</body>
<script>
</script>
</html>
<script src="/static/js/webflow.js" type="text/javascript"></script> -->

{extend name="../application/index/view/public/_header2_layout.html" }

{block name="meta"}
<title>{$Think.lang.referral}</title>
<meta content="{$Think.lang.referral}" property="og:title">
{/block}


{block name="css"}
<style>
    .sales-network #search{
        width: 100%;
    }

    .sales-network .search-container div:first-of-type
    {   
        padding-left: 0;
    }
    .sales-network .search-container div:first-of-type{
        padding-right: 0;
    }

    @media screen and (max-width: 992px){
        .sales-network .search-container div{
            padding: 0;
            margin-bottom: 10px;
        }
    }

</style>

{/block}

{block name="body"}
<div class="container sales-network from-container-custom" data-fade="true">
    <div class="row module-title">
        <div>{$Think.lang.referral}</div>
    </div>

    <form class="row search-container" method="post" action="<?php echo url('/referrer/search')?>">
        <div class="col-md-2">
            <input type="text" class="form-control" maxlength="256" name="first_name" data-name="first_name"
                placeholder="{$Think.lang.first_name}" id="first_name">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control" maxlength="256" name="last_name" data-name="last_name" placeholder="{$Think.lang.last_name}"
                id="last_name">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control" maxlength="256" name="username" data-name="username" placeholder="{$Think.lang.username}"
                id="username">
        </div>
        <div class="col-md-2">
            <input type="text" class="form-control" maxlength="256" name="channel_name" data-name="channel_name"
                placeholder="{$Think.lang.channel_name}" id="channel_name">
        </div>
        <div class="col-md-2">
            <select id="change_role" onchange="change(this)">
                <option value="0">销售</option>
                <option value="1">医生</option>
            </select>
        </div>
        <div class="col-md-2">
            <button id="search" class="btn custom-btn"> {$Think.lang.search} </button>
        </div>
    </form>
    <div class="row">
        <table class="table" width="100%" cellspacing="0" cellpadding="0">
            <thead>
                <tr>
                    <td>{$Think.lang.channel_name}</td>
                    <td>{$Think.lang.first_name}</td>
                    <td>{$Think.lang.last_name}</td>
                    <td>{$Think.lang.username}</td>
                    <td>{$Think.lang.phone}</td>
                    <td>{$Think.lang.signup_date}</td>
                </tr>
            </thead>
            <tbody>

            {volist name="data" id="vo"}
                
            <?php
                    $list[0] = $vo;
                    $c_fix = '';
                    while(!empty($list))
                    {
                        $one = array_shift($list);
                        
                            echo "<tr>";
                            echo "<td>$one[channel_name]</td>"; 
                            echo "<td>$one[first_name]</td>";
                            echo "<td>$one[last_name]</td>";
                            echo "<td>$c_fix$one[user_name]</td>";
                            echo "<td></td>";
                            echo "<td>$one[create_time]</td>";
                            echo "</tr>";

                            if(isset($one['_child'])){
                            $list = array_merge($list,$one['_child']);
                        }
                        $c_fix.= '--';
                    }
                ?>
            {/volist}

                <!-- <tr>
                    <td data-label="测试">123</td>
                    <td data-label="测试">123</td>
                    <td data-label="测试">23424234234</td>
                    <td data-label="测试">23424234234</td>
                    <td data-label="测试">23424234234</td>
                </tr>

                <tr>
                    <td data-label="测试">123</td>
                    <td data-label="测试">123</td>
                    <td data-label="测试">23424234234</td>
                    <td data-label="测试">23424234234</td>
                    <td data-label="测试">23424234234</td>
                </tr> -->
            </tbody>
        </table>
    </div>
</div>
<script type="text/javascript">
    function change(obj){
        var val = $(obj).val();
        $.ajax({
            url: 'changeRole',
            type: 'POST',
            data: {"role": val},
            dataType: 'json',
            success: function (result) {
                // console.log(result.data);
                var res = getDataList(result.data);
               $('tbody').html(res);
                
                html = '';
            }
        });
    }
var html='';
function getDataList(data){
    for (var i = 0; i < data.length; i++) {
        var list = [data[i]];
        //console.log(list);
        var c_fix = '';
        while(list != ''){
            var one = list.shift();
            //console.log(one);
            html += "<tr>" +
                    "<td>" +one.channel_name+ "</td>" +
                    "<td>" +one.last_name+ "</td>" +
                    "<td>" +one.first_name+ "</td>" +
                    "<td>" +c_fix+one.user_name+ "</td>" +
                    "<td>" +phone+ "</td>" +
                    "<td>" +one.create_time+ "</td>" +
                    "</tr>";
            // console.log(one);
            if( typeof one._child != "undefined" ) {
                list = list.concat(one._child);
                // console.log(list);
            }
            c_fix+='--';
        }
    }
    return html;
}
</script>
{/block}

{block name="script"}

{/block}
